bl() {
    most /havana/.build-cache/build-root-$1-$2/.build.log
}

bzit() {
    if [ ! -z $1 ]; then
        tar --exclude-vcs -cjf $1.tar.bz2 $1
    fi
}

browser () {
    f=`mktemp --suffix=.html`
    cat /dev/stdin > $f
    xdg-open $f
}

dumpenv () {
    sudo cat /proc/$1/environ | xargs --null --max-args=1
}

extract () {
    if [ -f $1 ] ; then
      case $1 in
        *.tar.lzma|*.tar.bz2|*.tar.gz|*.tar|*.tbz2|*.tgz)
                     tar xvf $1     ;;
        *.lzma)
                     lzma -d $1     ;;
        *.bz2)       bunzip2 $1     ;;
        *.rar)       unrar e $1     ;;
        *.gz)        gunzip $1      ;;
        *.zip)       unzip $1       ;;
        *.Z)         uncompress $1  ;;
        *.7z)        7z x $1        ;;
        *)     echo "'$1' cannot be extracted via extract()" ;;
         esac
     else
         echo "'$1' is not a valid file"
     fi
}

find_broken_symlinks() {
    find -L $1 -type l -exec ls -lF --color=yes '{}' +
}

ftrace () {
    strace -f -e trace=file $@
}

ifgoogle () {
    useragent="Mozilla/5.0 AppleWebKit/537.35 (KHTML, like Gecko) Chrome/27.0.1448.0 Safari/537.35"
    url="https://www.google.com/search?q=whats+my+ip"
    curl -s -A $useragent $url | grep -oP '(?<=Your public IP address is <em>).*?(?=</em>)'
}

kde_release() {
    cmake -DCMAKE_SKIP_RPATH=ON -DCMAKE_INSTALL_PREFIX=/usr \
          -DLIBEXEC_INSTALL_DIR:PATH=/usr/lib64/kde4/libexec \
          -DLIB_SUFFIX=64 -DCMAKE_BUILD_TYPE=release ..
}

kde_debug() {
    cmake -DCMAKE_SKIP_RPATH=ON -DCMAKE_INSTALL_PREFIX=/usr \
          -DLIBEXEC_INSTALL_DIR:PATH=/usr/lib64/kde4/libexec \
          -DLIB_SUFFIX=64 -DCMAKE_BUILD_TYPE=debug ..
}

latest_dolphin () {
    curl -s "http://dolphin-emu.org/download/?ref=btn" | \
    perl -ne 'CORE::say $1 and exit if /download\/dev\/\S+\/">(\d\.\d-\d+)/'
}

lupx () {
    upx --best --lzma $@
}

mcd () {
    mkdir -p "$1" && cd "$1";
}

mp3() {
    youtube-dl --extract-audio --title --audio-format mp3 "$1"
}

mvim () {
    if [ -z "$@" ]; then
        gvim --remote-tab-silent "New Document"
    else
        gvim --remote-tab-silent $@
    fi
}

sniff () {
    sudo ngrep -d ${1} -t '^(GET|POST) ' 'tcp and port 80';
}

sshproxy() {
    # Usage sproxy port username@host
    ssh -fND localhost:$1 $2
}

tl() {
    tail -f /havana/.build-cache/build-root-$1-$2/.build.log
}

unrpm() {
    if [ -e $1 ]; then
        rpm2cpio $1 | cpio -imdv
    fi
}

vstream() {
    vlc "$1" --sout '#transcode{vcodec=h264,acodec=mp3,ab=128,channels=2,samplerate=44100}:http{dst=:8080/go.mpg}'
}

ydl() {
    youtube-dl --prefer-free-formats "$1" -o %(title)s.%(ext)s
}
